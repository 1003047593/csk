# 修复Linux 内核漏洞CVE-2019-11477的公告 {#concept_878721 .concept}

## 背景信息 {#section_5zj_ldk_asi .section}

Linux 内核2.6.29及之后版本在处理TCP SACK机制时存在缺陷，导致整数溢出漏洞，攻击者可以构造特定的SACK包，远程触发Linux服务器内核模块溢出漏洞，实现远程拒绝服务攻击。

漏洞CVE-2019-11477的详细信息，请参见[https://help.aliyun.com/noticelist/articleid/1060012493.html](https://help.aliyun.com/noticelist/articleid/1060012493.html)。

## 解决方法 {#section_yng_khd_stk .section}

容器服务将于近期统一升级集群节点中的基础镜像，新镜像内核版本中包含了针对上述漏洞的修复；对于已有集群中的节点，修复建议如下：

**升级Linux安全补丁** 

**说明：** 修复需要重启节点服务器，请您务必谨慎操作并选择在业务非高峰期执行相关操作。

-   登录至集群各节点中执行`yum update kernel`更新内核版本。
-   对于集群Master节点，请您在完成一个节点的重启操作并确认该节点上 Kubernetes 组件服务恢复正常后，再进行下一个Master节点的重启。
-   对于集群Worker节点，您需要首先确保节点上的单点服务迁移至其他节点上，以避免节点重启过程中的服务中断。您可以通过排水操作（即，执行`kubectl drain`命令），首先标记该节点为不可调度状态，并驱逐相应服务（适用于由 ReplicationController, ReplicaSet, Job, DaemonSet or StatefulSet 控制的Pod实例）；在完成目标节点的服务迁移后您可以重启节点服务器，并在重启完成后使用`kubectl uncordon $nodename` 命令使节点重新可调度。
-   运行官方脚本[https://access.redhat.com/sites/default/files/cve-2019-11477--2019-06-17-1629.sh](https://access.redhat.com/sites/default/files/cve-2019-11477--2019-06-17-1629.sh)，确认漏洞问题已修复。

您也可以通过如下措施缓解漏洞问题。

-   禁用SACK机制功能，执行如下命令。

    ``` {#codeblock_zfo_dbb_b1j}
    echo 0 > /proc/sys/net/ipv4/tcp_sack
    sysctl -w net.ipv4.tcp_sack=0
    ```

    **说明：** 该操作会影响TCP连接处理效率，请在操作前评估对业务可用性的影响。

-   使用过滤器阻止低MSS连接。具体命令参见[https://github.com/Netflix/security-bulletins/blob/master/advisories/third-party/2019-001/block-low-mss/README.md](https://github.com/Netflix/security-bulletins/blob/master/advisories/third-party/2019-001/block-low-mss/README.md)。

    **说明：** 需要禁用TCP探测时有效（即在/etc/sysctl.conf文件中将`net.ipv4.tcp_mtu_probingsysctl`设置为0），该措施会影响合法的低MSS连接，请在操作前评估对业务可用性的影响。


